<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zzptc.twds.dao.TCoursesMapper" >
  <resultMap id="BaseResultMap" type="com.zzptc.twds.pojo.TCourses" >
    <id column="tId" property="tid" jdbcType="INTEGER" />
    <result column="co_id" property="coId" jdbcType="INTEGER" />
    <result column="username" property="username" jdbcType="VARCHAR" />
    <result column="cl_id" property="clId" jdbcType="INTEGER" />
    <result column="state" property="state" jdbcType="CHAR" />
  </resultMap>
  
    <sql id="Base_Column_List" >
    tId, co_id, username, cl_id,state
  </sql>
  
  
    <insert id="insertSelective" parameterType="com.zzptc.twds.pojo.TCourses" >
    insert into t_courses
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="tid != null" >
        tId,
      </if>
      <if test="coId != null" >
        co_id,
      </if>
      <if test="username != null" >
          username,
      </if>
      <if test="clId != null" >
        cl_id,
      </if>
       <if test="state != null" >
       state
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="tid != null" >
        #{tid,jdbcType=INTEGER},
      </if>
      <if test="coId != null" >
        #{coId,jdbcType=INTEGER},
      </if>
      <if test="username != null" >
        #{username,jdbcType=VARCHAR},
      </if>
      <if test="clId != null" >
        #{clId,jdbcType=INTEGER},
      </if>
       <if test="state != null" >
        #{state,jdbcType=CHAR},
      </if>
    </trim>
  </insert>
  
  <select id="selectAll" resultMap="BaseResultMap"  >
  	select * from t_courses  ;
 
  </select>
  
  <select id="selectByPrimaryKey"  resultMap="BaseResultMap" parameterType="java.lang.Integer">
  
  	select * from t_courses where tId= #{tid,jdbcType=INTEGER}
  
  </select>

    <select id="selectOtherWorkByUserName" resultMap="tAllworks" parameterType="java.lang.String">
 	select t1.*,t2.*,t3.*   from toworkload t1,oworkload t2,user t3
  	where t1.oid=t2.oid and t1.username=t3.username and t1.state=2 and t1.username=#{username,jdbcType=VARCHAR}
  </select>
    <select id="selectOtherWorkByAdmin" resultMap="tAllworks" >
 	select t1.*,t2.*,t3.*   from toworkload t1,oworkload t2,user t3
  	where t1.oid=t2.oid and t1.username=t3.username and t1.state=2
  </select>
   <select id="selectDeclareTworkView" resultMap="tAllworks" parameterType="java.lang.String">
 	select t1.*,t2.*,t3.*   from toworkload t1,oworkload t2,user t3
  	where t1.oid=t2.oid and t1.username=t3.username and t1.username=#{username,jdbcType=VARCHAR}
  </select>
    <select id="selectDeclareScientificView" resultMap="tAllscientific" parameterType="java.lang.String">
 	select t1.*,t2.*,t3.*   from toscientific t1,scientific t2,user t3
  	where t1.oid=t2.scientificId and t1.username=t3.username and t1.username=#{username,jdbcType=VARCHAR}
    </select>
    <select id="selectScientificByUserName" resultMap="tAllscientific" parameterType="java.lang.String">
 	select t1.*,t2.*,t3.*   from toscientific t1,scientific t2,user t3
  	where t1.oid=t2.scientificId and t1.username=t3.username and t1.state=2 and t1.username=#{username,jdbcType=VARCHAR}
  </select>
    <select id="selectScientificByAdmin" resultMap="tAllscientific" >
 	select t1.*,t2.*,t3.*   from toscientific t1,scientific t2,user t3
  	where t1.oid=t2.scientificId and t1.username=t3.username and t1.state=2
  </select>
    <select id="selectOtherTwork" resultMap="tAllworks" >
 	select t1.*,t2.*,t3.*   from toworkload t1,oworkload t2,user t3
  	where t1.oid=t2.oid and t1.username=t3.username and t1.state!=0
  </select>
    <select id="selectOtherTworks" resultMap="tAllworks" parameterType="java.lang.Integer">
 	select t1.*,t2.*,t3.*   from toworkload t1,oworkload t2,user t3
  	where t1.oid=t2.oid and t1.username=t3.username and t1.state!=0 and t3.c_id=#{cid,jdbcType=VARCHAR}
  </select>
    <select id="selectAllTCoursesByUserid" resultMap="tCoursesAll" parameterType="java.lang.String">
 	select t2.*,t3.*,t4.*,t1.tId, t1.content as content  from t_courses t1,courses t2,classes t3,user t4
  	where t1.co_id=t2.co_id and t1.cl_id=t3.cl_id and t1.username=t4.username  and t1.username= #{username,jdbcType=VARCHAR}   order by
		t2.co_total desc
  </select>
    <select id="selectAllTCoursesByUserName" resultMap="tCoursesAll" parameterType="java.lang.String">
 	select t2.*,t3.*,t4.*,t1.tId, t1.content as content  from t_courses t1,courses t2,classes t3,user t4
  	where t1.co_id=t2.co_id and t1.cl_id=t3.cl_id and t1.username=t4.username and t1.state='2' and t1.username= #{username,jdbcType=VARCHAR} order by
		t2.co_term
  </select>
    <select id="selectAllTCoursesByAdmin" resultMap="tCoursesAll" >
 	select t2.*,t3.*,t4.*,t1.tId, t1.content as content  from t_courses t1,courses t2,classes t3,user t4
  	where t1.co_id=t2.co_id and t1.cl_id=t3.cl_id and t1.username=t4.username and t1.state='2'  order by
		t2.co_term
  </select>
    <select id="selectAllTCourses" resultMap="tCoursesAll" >
  	select t2.*,t3.*,t4.*,t5.*,t1.tId,case t1.state when '0' then '审核中' when '1' then '申报通过' when '2' then '申报失败' end as state  from t_courses t1,courses t2,classes t3,user t4,formula t5
  	where t1.co_id=t2.co_id and t1.cl_id=t3.cl_id and t1.userId=t4.userId and t2.fId=t5.fId 
 
  </select>

    <select id="searchState" resultType="String"  parameterType="java.lang.Integer" >
  	select state from t_courses
  	where tId=#{tid,jdbcType=INTEGER}

  </select>

    <select id="selectScientificWorks" resultMap="tAllscientific" >
 	select t1.state as state,t1.*,t2.*,t3.*   from toscientific t1,scientific t2,user t3
  	where t1.oId=t2.scientificId and t1.username=t3.username and t1.state!=0
  </select>
    <select id="selectScientificWork" resultMap="tAllscientific" parameterType="java.lang.Integer">
 	select t1.state as state, t1.*,t2.*,t3.*   from toscientific t1,scientific t2,user t3
  		where t1.oId=t2.scientificId and t1.username=t3.username and t1.state!=0 and t3.c_id=#{cid,jdbcType=VARCHAR}
  </select>


    <select id="searchStates" resultType="Integer"  parameterType="java.lang.Integer" >
  	select state from toworkload
  	where toId=#{toId,jdbcType=INTEGER}

  </select>

    <select id="searchScientificState" resultType="Integer"  parameterType="java.lang.Integer" >
  	select state from toscientific
  	where toId=#{toId,jdbcType=INTEGER}

  </select>
    <resultMap id="tAllscientific" type="com.zzptc.twds.pojo.Toscientific" >
        <id column="toid" property="toid" jdbcType="INTEGER" />
        <result column="oid" property="oid" jdbcType="INTEGER" />
        <result column="username" property="username" jdbcType="VARCHAR" />
        <result column="toname" property="toname" jdbcType="VARCHAR" />
        <result column="time" property="time" jdbcType="VARCHAR" />
        <result column="content" property="content" jdbcType="VARCHAR" />
        <association property="scientific" javaType="com.zzptc.twds.pojo.Scientific">
            <id column="scientificId" property="scientificId" jdbcType="INTEGER" />
            <result column="state" property="state" jdbcType="INTEGER" />
            <result column="para" property="para" jdbcType="DOUBLE" />
            <result column="scientificName" property="scientificName" jdbcType="VARCHAR" />
            <result column="value" property="value" jdbcType="DOUBLE" />

        </association>

        <association property="user" javaType="com.zzptc.twds.pojo.User">
            <id column="username" property="username" jdbcType="VARCHAR" />
            <result column="name" property="name" jdbcType="VARCHAR" />
        </association>

    </resultMap>

    <resultMap id="tAllworks" type="com.zzptc.twds.pojo.Toworkload" >
        <id column="toid" property="toid" jdbcType="INTEGER" />
        <result column="oid" property="oid" jdbcType="INTEGER" />
        <result column="username" property="username" jdbcType="VARCHAR" />
        <result column="toname" property="toname" jdbcType="VARCHAR" />
        <result column="totime" property="totime" jdbcType="VARCHAR" />
        <result column="content" property="content" jdbcType="VARCHAR" />
        <association property="oworkload" javaType="com.zzptc.twds.pojo.Oworkload">
            <id column="oid" property="oid" jdbcType="INTEGER" />
            <result column="state" property="state" jdbcType="INTEGER" />
            <result column="para" property="para" jdbcType="DOUBLE" />
            <result column="otype" property="otype" jdbcType="VARCHAR" />
            <result column="ovalue" property="ovalue" jdbcType="DOUBLE" />

        </association>

      <association property="user" javaType="com.zzptc.twds.pojo.User">
        <id column="username" property="username" jdbcType="VARCHAR" />
            <result column="name" property="name" jdbcType="VARCHAR" />
    </association>

    </resultMap>


    <resultMap id="tCoursesAll" type="com.zzptc.twds.pojo.TCourses" >
   	    <id column="tId" property="tid" jdbcType="INTEGER" />
	    <result column="co_id" property="coId" jdbcType="INTEGER" />
	    <result column="username" property="username" jdbcType="VARCHAR" />
	    <result column="cl_id" property="clId" jdbcType="INTEGER" />
	    <result column="content" property="content" jdbcType="VARCHAR" />
   		<association property="courses" javaType="com.zzptc.twds.pojo.Courses">
    		 <id column="co_id" property="coId" jdbcType="INTEGER" />
		    <result column="c_id" property="cId" jdbcType="INTEGER" />
		    <result column="fId" property="fid" jdbcType="INTEGER" />
		    <result column="co_name" property="coName" jdbcType="VARCHAR" />
		     <result column="co_type" property="coType" jdbcType="VARCHAR" />
		    <result column="co_week" property="coWeek" jdbcType="DOUBLE" />
		    <result column="co_weNum" property="coWenum" jdbcType="INTEGER" />
		    <result column="co_total" property="coTotal" jdbcType="DOUBLE" />
		    <result column="co_term" property="coTerm" jdbcType="VARCHAR" />
   		</association>
    	<association property="classes" javaType="com.zzptc.twds.pojo.Classes">
	    	<id column="cl_id" property="clId" jdbcType="INTEGER" />
		    <result column="mId" property="mid" jdbcType="INTEGER" />
		    <result column="cl_name" property="clName" jdbcType="VARCHAR" />
		    <result column="cl_year" property="clYear" jdbcType="DATE" />
		    <result column="cl_num" property="clNum" jdbcType="INTEGER" />
    
    	</association>
    	<association property="user" javaType="com.zzptc.twds.pojo.User" >
    		 <id column="username" property="username" jdbcType="VARCHAR" />
		    <result column="name" property="name" jdbcType="VARCHAR" />
    	</association>
    	<!-- <association property="formula" javaType="com.zzptc.twds.pojo.Formula">
    	<id column="fId" property="fid" jdbcType="INTEGER" />
   		 <result column="fName" property="fname" jdbcType="VARCHAR" />
    	 <result column="expression" property="expression" jdbcType="VARCHAR" />
    </association>-->
    
  </resultMap>
  
    <select id="selectBycoId" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select 
    <include refid="Base_Column_List" />
    from t_courses
    where co_id = #{coId,jdbcType=INTEGER}
  </select>
  
  
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from t_courses
    where tId = #{tid,jdbcType=INTEGER}
  </delete>
  
  
   <update id="updateByPrimaryKeySelective" parameterType="com.zzptc.twds.pojo.TCourses" >
    update t_courses
    <set >
      <if test="coId != null" >
        co_id = #{coId,jdbcType=INTEGER},
      </if>
      <if test="username != null" >
          username = #{username,jdbcType=INTEGER},
      </if>
      <if test="clId != null" >
        cl_id = #{clId,jdbcType=INTEGER},
      </if>
        <if test="state != null" >
            state = #{state,jdbcType=VARCHAR},
        </if>
    </set>
    where tId = #{tid,jdbcType=INTEGER}
  </update>

    <update id="updateTwork" parameterType="com.zzptc.twds.pojo.Toworkload" >
    update toworkload
    <set >
        <if test="toid != null" >
            toId = #{toid,jdbcType=INTEGER},
        </if>
        <if test="username != null" >
            username = #{username,jdbcType=INTEGER},
        </if>
        <if test="state != null" >
            state = #{state,jdbcType=INTEGER},
        </if>
    </set>
    where toId = #{toid,jdbcType=INTEGER}
</update>

    <update id="updateTScientific" parameterType="com.zzptc.twds.pojo.Toscientific" >
        update toscientific
        <set >
            <if test="toid != null" >
                toId = #{toid,jdbcType=INTEGER},
            </if>
            <if test="username != null" >
                username = #{username,jdbcType=INTEGER},
            </if>
            <if test="state != null" >
                state = #{state,jdbcType=INTEGER},
            </if>
        </set>
        where toId = #{toid,jdbcType=INTEGER}
    </update>
</mapper>